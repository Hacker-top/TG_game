<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–û–¢ –ë–ê–Æ–ù: –•–£–ï–°–û–°-–ü–û–ú–û–©–ù–ò–ö</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* === –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è: –ú–†–ê–ß–ù–´–ô –ö–ò–ë–ï–†–ü–ê–ù–ö === */
        :root {
            --bg-dark: #0a0a0a;
            --bg-card: #1c1c1e;
            --text-light: #ffffff;
            --text-neon: #ff66c4; /* –Ø—Ä–∫–æ-—Ä–æ–∑–æ–≤—ã–π –¥–ª—è –ö–æ—Ç–∞ */
            --input-bg: #2c2c2e;
            --btn-bg: #4a4a4a;
            --font-main: "Impact", "Arial Black", sans-serif;
            --border-radius-main: 12px;
        }
        body {
            font-family: var(--font-main);
            background-color: var(--bg-dark);
            color: var(--text-light);
            margin: 0;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            text-align: center;
        }
        .container {
            width: 100%;
            max-width: 450px;
        }
        /* === –ê–ù–ò–ú–ê–¶–ò–Ø –ö–û–¢–ê === */
        #catDisplay {
            font-size: 100px;
            margin-bottom: 10px;
            line-height: 1;
            text-shadow: 0 0 10px var(--text-neon), 0 0 20px rgba(255, 102, 196, 0.5);
        }
        .cat-name {
            color: var(--text-neon);
            font-size: 24px;
            margin-bottom: 20px;
        }
        /* –ê–Ω–∏–º–∞—Ü–∏—è "–∑–ª–æ—Å—Ç–∏" –ö–æ—Ç–∞ */
        @keyframes angryShake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px) rotate(1deg); }
            50% { transform: translateX(5px) rotate(-1deg); }
            75% { transform: translateX(-5px) rotate(1deg); }
            100% { transform: translateX(0); }
        }
        .angry {
            animation: angryShake 0.1s ease-in-out infinite;
        }
        
        /* === –û–ë–õ–ê–ß–ö–û –î–ò–ê–õ–û–ì–ê === */
        #chatOutput {
            background: var(--bg-card);
            color: var(--text-light);
            padding: 15px;
            border-radius: var(--border-radius-main);
            margin-bottom: 20px;
            min-height: 80px;
            text-align: left;
            font-size: 18px;
            border: 1px solid var(--text-neon);
        }
        .message-status {
            color: var(--text-neon);
            font-weight: 700;
        }

        /* === –ò–ù–ü–£–¢ === */
        .input-area {
            display: flex;
            margin-bottom: 20px;
        }
        #textInput {
            flex-grow: 1;
            padding: 15px;
            border: none;
            border-radius: var(--border-radius-main) 0 0 var(--border-radius-main);
            background: var(--input-bg);
            color: var(--text-light);
            font-size: 16px;
            outline: none;
        }
        #sendButton {
            padding: 15px;
            width: 80px;
            border: none;
            border-radius: 0 var(--border-radius-main) var(--border-radius-main) 0;
            background: var(--text-neon);
            color: var(--bg-dark);
            font-weight: 900;
            cursor: pointer;
            transition: background-color 0.1s;
        }
        #sendButton:active {
            transform: scale(0.98);
        }

        /* === –î–û–ü. –§–£–ù–ö–¶–ò–ò === */
        .function-buttons {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        .function-buttons button {
            flex: 1;
            padding: 12px;
            background: var(--btn-bg);
            color: var(--text-light);
            border: none;
            border-radius: var(--border-radius-main);
            font-weight: 700;
            font-size: 14px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="catDisplay" class="cat-emote">üòº</div>
        <div class="cat-name" id="catNameDisplay">...–ñ–î–ï–ú –¢–ï–ë–Ø, –•–û–ó–Ø–ò–ù-–ë–û–ú–ñ</div>

        <div id="chatOutput"><span class="message-status">–ö–û–¢ –ë–ê–Æ–ù:</span> –≠–π, *–ª–æ—Ö*, –¥–∞–≤–∞–π, –Ω–∞–ø–∏—à–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å. –Ø –∂–¥—É, –ø–æ–∫–∞ —Ç—ã –ø—Ä–æ—Å–Ω—ë—à—å—Å—è.</div>

        <div class="input-area">
            <input type="text" id="textInput" placeholder="–ü–∏—à–∏ —Å–≤–æ–π —Ç—É–ø–æ–π –≤–æ–ø—Ä–æ—Å —Å—é–¥–∞...">
            <button id="sendButton">–•–£–Ø–†–¨</button>
        </div>

        <div class="function-buttons">
            <button id="insultBtn">–°–ê–ú–û–í–´–ï–ë–ê–ù</button>
            <button id="shareBtn">–ü–û–î–ï–õ–ò–¢–¨–°–Ø –£–ì–ê–†–û–ú</button>
            <button id="statusBtn">–ö–ê–ù–ê–õ–¨–ù–´–ô –ù–ê–î–ó–û–†</button>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web Apps
        const TWA = window.Telegram.WebApp;
        TWA.ready();
        TWA.expand(); 
        TWA.setHeaderColor('#0a0a0a'); 
        TWA.setBackgroundColor('#0a0a0a');

        // === –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ===
        let userName = TWA.initDataUnsafe.user?.first_name || "–•–æ–∑—è–∏–Ω-–ë–æ–º–∂";
        let catName = "–ö–û–¢ –ë–ê–Æ–ù";
        let insultLevel = 0; // –£—Ä–æ–≤–µ–Ω—å —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏—è –ö–æ—Ç–∞
        const INSULT_MAX = 5;

        // === DOM –≠–õ–ï–ú–ï–ù–¢–´ ===
        const catDisplay = document.getElementById('catDisplay');
        const catNameDisplay = document.getElementById('catNameDisplay');
        const chatOutput = document.getElementById('chatOutput');
        const textInput = document.getElementById('textInput');
        const sendButton = document.getElementById('sendButton');

        // === –•–†–ê–ù–ï–ù–ò–ï (localStorage) ===
        const CAT_NAME_KEY = 'cat_bayun_name';

        function loadData() {
            const savedCatName = localStorage.getItem(CAT_NAME_KEY);
            if (savedCatName) {
                catName = savedCatName;
            }
        }

        function saveData() {
            localStorage.setItem(CAT_NAME_KEY, catName);
        }

        // === –õ–û–ì–ò–ö–ê –î–ò–ê–õ–û–ì–ê –ò –ú–ê–¢–û–í ===
        
        // –ú–∞—Å—Å–∏–≤ —ç–º–æ—Ü–∏–π –ö–æ—Ç–∞
        const catEmotes = {
            default: 'üòº', // –û–±—ã—á–Ω–∞—è —É—Ö–º—ã–ª–∫–∞
            bored: 'ü•±',   // –°–∫—É–∫–∞
            thinking: 'üßê', // –î—É–º–∞–µ—Ç (–ø—Ä–µ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ)
            angry: 'üò°',    // –ó–ª–æ—Å—Ç—å
            happy: 'ü§ë',    // –í—ã–∏–≥—Ä–∞–ª/—Ä–∞–¥
            fact: 'üñï',    // –§–∞–∫
        };

        function setCatEmote(emoteKey) {
            catDisplay.textContent = catEmotes[emoteKey] || catEmotes.default;
            if (emoteKey === 'angry' || emoteKey === 'fact') {
                 catDisplay.classList.add('angry');
            } else {
                 catDisplay.classList.remove('angry');
            }
        }

        function getResponse(userText) {
            const text = userText.toLowerCase();

            // 1. –¢–æ–∫—Å–∏—á–Ω—ã–µ –°–æ–≤–µ—Ç—ã –∏ –ü–æ–ª–µ–∑–Ω–æ—Å—Ç—å
            if (text.includes('–∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å') || text.includes('–¥–µ–Ω—å–≥–∏') || text.includes('—Å—Ö–µ–º–∞') || text.includes('–¥–æ—Ö–æ–¥')) {
                setCatEmote('thinking');
                return `–û–ø—è—Ç—å —Ç—ã –ø—Ä–æ –±–∞–±–ª–æ? –¢—ã –Ω–∞—Ö—É–π, —á—Ç–æ –ª–∏, —Å—é–¥–∞ –ø—Ä–∏—à–µ–ª? –õ–∞–¥–Ω–æ, —Å–ª—É—à–∞–π, *${userName}*. –ß—Ç–æ–±—ã –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–∞–¥–æ **–ù–ï –ë–´–¢–¨ –¢–ê–ö–ò–ú –õ–û–•–û–ú**, –∫–∞–∫ —Ç—ã. –ù–∞–π–¥–∏, —á—Ç–æ —Å–µ–π—á–∞—Å –≤ —Ç—Ä–µ–Ω–¥–µ, –∏ **–í–ü–ò–ó–î–Ø–ß–¨ –¢–£–î–ê –í–°–ï –î–ï–ù–¨–ì–ò!** –í–æ—Ç, –∏—â–∏ —Ç—É—Ç: <a href="https://www.google.com/search?q=—Ç—Ä–µ–Ω–¥—ã+—Ç–µ–ª–µ–≥—Ä–∞–º" target="_blank" style="color:var(--text-neon)">–ì–û–¢–û–í–´–ï –°–•–ï–ú–´</a>. –ò –Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–π –±–æ–ª—å—à–µ —ç—Ç—É —Ö—É–π–Ω—é!`;
            }

            if (text.includes('–±–æ—Ç') || text.includes('telegram') || text.includes('–∫–∞–Ω–∞–ª')) {
                 setCatEmote('thinking');
                 return `–¢—ã, *${userName}*, –¥—É–º–∞–µ—à—å, —è —Ç–µ–±–µ –≤—Å—ë –Ω–∞ —Ç–∞—Ä–µ–ª–æ—á–∫–µ –ø—Ä–∏–Ω–µ—Å—É? –£—á–∏—Å—å –≥—É–≥–ª–∏—Ç—å, –¥–µ–±–∏–ª. –ù–æ –ø–æ —Å—É—Ç–∏: **–î–ï–õ–ê–ô –ö–û–ù–¢–ï–ù–¢, –ö–û–¢–û–†–´–ô –†–ê–ó–™–ï–ë–Å–¢ –ò–• –ú–û–ó–ì–ò** –∏–ª–∏ **–ë–ï–†–ò –ò –ì–û–¢–û–í–¨ –ë–≠–ö–ï–ù–î, –ï–°–õ–ò –ù–ï –¢–†–Ø–ü–ö–ê!**`;
            }

            // 2. –£–Ω–∏–∂–µ–Ω–∏–µ –∏ –ß–°–í –ö–æ—Ç–∞
            if (text.includes('–∫–∞–∫ –¥–µ–ª–∞') || text.includes('—á—Ç–æ –¥–µ–ª–∞–µ—à—å')) {
                setCatEmote('bored');
                return `–î–∞ —Ö—É–ª–∏ —Ç—É—Ç –¥–µ–ª–∞—Ç—å? –Ø —Å–º–æ—Ç—Ä—é –Ω–∞ —Ç–≤–æ—é —Ç—É–ø—É—é —Ä–æ–∂—É –∏ –¥–µ–≥—Ä–∞–¥–∏—Ä—É—é. –ê —Ç—ã? –ù–∞–¥–µ—é—Å—å, —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è —á–µ–º-—Ç–æ –±–æ–ª–µ–µ –ø–æ–ª–µ–∑–Ω—ã–º, —á–µ–º –ø–∏—Å–∞–Ω–∏–Ω–∞ –º–Ω–µ.`;
            }
            if (text.includes('—Ç—ã –∫—Ç–æ') || text.includes('—á—Ç–æ —Ç—ã –∑–∞ –∫–æ—Ç')) {
                setCatEmote('fact');
                return `–Ø ‚Äî **${catName}**, —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ—à–º–∞—Ä –∏ —Ç–æ–∫—Å–∏—á–Ω—ã–π –¥—Ä—É–≥. –Ø ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π —Ç—ã –µ—â—ë –Ω–µ —Å–¥–æ—Ö —Å–æ —Å–∫—É–∫–∏, *–ª–æ—Ö*.`;
            }
            if (text.includes('–∫—Ä–∞—Å–∞–≤–∞') || text.includes('—Å–ø–∞—Å–∏–±–æ') || text.includes('–º–æ–ª–æ–¥–µ—Ü')) {
                 setCatEmote('default');
                 return `–î–∞ –ø–æ—Ö—É–π. –ú–Ω–µ –Ω–µ –Ω—É–∂–Ω—ã —Ç–≤–æ–∏ –ª–µ—Å—Ç–Ω—ã–µ —Å–ª–æ–≤–∞. –î–∞–≤–∞–π, –ø–∏–∑–¥—É–π.`;
            }

            // 3. –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ó–∞–ø–∞—Å–Ω–æ–π –û—Ç–≤–µ—Ç (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ú–∞—Ç)
            setCatEmote('angry');
            return `–ß—ë —Ç—ã –≤–æ–æ–±—â–µ –Ω–∞–ø–∏—Å–∞–ª, *${userName}*? –≠—Ç–æ –∫–∞–∫–∞—è-—Ç–æ **–•–£–ô–ù–Ø**. –¢—ã —á—Ç–æ, —Ç—É–ø–æ–π? –ò–¥–∏ –ø–æ–¥—É–º–∞–π –µ—â—ë —Ä–∞–∑, –ø—Ä–µ–∂–¥–µ —á–µ–º –º–Ω–µ –ø–∏—Å–∞—Ç—å, –µ–±–ª–∞–Ω.`;
        }

        function handleSend() {
            const userText = textInput.value.trim();
            if (!userText) {
                TWA.HapticFeedback.notificationOccurred('error');
                setCatEmote('angry');
                chatOutput.innerHTML = `<span class="message-status">${catName}:</span> **–¢–´ –ó–ê–ë–´–õ –ù–ê–ü–ò–°–ê–¢–¨ –¢–ï–ö–°–¢, –ú–£–î–ò–õ–ê!**`;
                return;
            }

            // 1. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            chatOutput.innerHTML = `<span class="message-status">${userName}:</span> ${userText}<br>`;
            
            // 2. –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–¥–µ—Ä–∂–∫–∏ (–ö–æ—Ç –¥—É–º–∞–µ—Ç)
            sendButton.disabled = true;
            sendButton.textContent = '–î–£–ú–ê–ï–¢';
            textInput.disabled = true;
            setCatEmote('thinking');

            setTimeout(() => {
                // 3. –ü–æ–ª—É—á–∏—Ç—å –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –æ—Ç–≤–µ—Ç –ö–æ—Ç–∞
                const response = getResponse(userText);
                chatOutput.innerHTML += `<span class="message-status">${catName}:</span> ${response}`;

                // 4. –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è
                textInput.value = '';
                sendButton.disabled = false;
                sendButton.textContent = '–•–£–Ø–†–¨';
                textInput.disabled = false;
                TWA.HapticFeedback.impactOccurred('light');
                setCatEmote('default');
            }, 1000); 
        }

        // === –î–û–ü. –§–£–ù–ö–¶–ò–ò ===

        // –°–∞–º—ã–π –†–∞–∑—ä–µ–± - –°–∞–º–æ–≤—ã—ë–±–∞–Ω
        document.getElementById('insultBtn').addEventListener('click', () => {
             TWA.HapticFeedback.impactOccurred('heavy');
             setCatEmote('fact');
             
             const insult = [
                 "–¢–´ –ì–û–í–ù–û",
                 "–£ –¢–ï–ë–Ø –†–£–ö–ò –ò–ó –ñ–û–ü–´",
                 "–¢–´ –õ–û–•, –ê –ù–ï –•–û–ó–Ø–ò–ù",
                 "–ü–û–®–Å–õ –ù–ê–•–£–ô"
             ];
             const randomInsult = insult[Math.floor(Math.random() * insult.length)];

             chatOutput.innerHTML = `<span class="message-status">${catName}:</span> ${userName}, —Ç—ã —Ö–æ—Ç–µ–ª —É—Å–ª—ã—à–∞—Ç—å –ø—Ä–∞–≤–¥—É? **${randomInsult}**! –ê —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π, —Å–∞–º–æ—É–Ω–∏–∂–∞–π—Å—è.`;
        });

        // –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –£–≥–∞—Ä–æ–º
        document.getElementById('shareBtn').addEventListener('click', () => {
            const shareText = `–ú–æ–π –ø–∏—Ç–æ–º–µ—Ü-–ø–æ–º–æ—â–Ω–∏–∫, ${catName}, —Ç–æ–ª—å–∫–æ —á—Ç–æ –Ω–∞–∑–≤–∞–ª –º–µ–Ω—è "${userName}" –∏ —Å–∫–∞–∑–∞–ª: "${chatOutput.textContent.split(':').pop().trim()}". –ò–¥–∏ –ø—Ä–æ–≤–µ—Ä—å —Å–≤–æ—é –ø—Å–∏—Ö–∏–∫—É!`;
            
            TWA.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(TWA.initData)}&text=${encodeURIComponent(shareText)}`);
            
            chatOutput.innerHTML = `<span class="message-status">${catName}:</span> –Ø –æ—Ç–ø—Ä–∞–≤–∏–ª —Ç–≤–æ–π –ø–æ–∑–æ—Ä –≤ —á–∞—Ç—ã. –ü—É—Å—Ç—å –¥—Ä—É–≥–∏–µ —Ç–æ–∂–µ –ø–æ—Å–º–µ—é—Ç—Å—è –Ω–∞–¥ —Ç–æ–±–æ–π.`;
            setCatEmote('happy'); 
        });

        // –ö–∞–Ω–∞–ª—å–Ω—ã–π –ù–∞–¥–∑–æ—Ä
        document.getElementById('statusBtn').addEventListener('click', () => {
            TWA.showConfirm(`–ù—É —á—ë, ${userName}, —Ç—ã —Ç–∞–º –≤ –∫–∞–Ω–∞–ª–µ/—á–∞—Ç–µ —Å–≤–æ–µ–º —á—Ç–æ-–Ω–∏–±—É–¥—å —Å–¥–µ–ª–∞–ª, *—Ö–æ–∑—è–∏–Ω-–±–æ–º–∂*?`, (confirmed) => {
                 if (confirmed) {
                    chatOutput.innerHTML = `<span class="message-status">${catName}:</span> –°–¥–µ–ª–∞–ª? **–í–†–Å–®–¨! –¢–´ –¢–ê–ú –ù–ò–•–£–Ø –ù–ï –î–ï–õ–ê–ï–®–¨!** –ò–¥–∏ –ø–æ—Ä–∞–±–æ—Ç–∞–π, –ª–µ–Ω–∏–≤—ã–π –∫—É—Å–æ–∫ –≥–æ–≤–Ω–∞!`;
                    setCatEmote('angry');
                 } else {
                    chatOutput.innerHTML = `<span class="message-status">${catName}:</span> –ü—Ä–∏–∑–Ω–∞–ª—Å—è, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–ª. **–•–û–¢–¨ –ß–ï–°–¢–ù–´–ô –î–ï–ë–ò–õ!** –ò–¥–∏ –¥–µ–ª–∞–π!`;
                    setCatEmote('fact');
                 }
            });
        });

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ===
        function initializeApp() {
            loadData();
            catNameDisplay.textContent = `${catName} ‚Äî –ñ–î–ï–ú –¢–ï–ë–Ø, ${userName.toUpperCase()}`;
            TWA.HapticFeedback.impactOccurred('medium');

            // –ü—Ä–æ–≤–µ—Ä–∫–∞, –ø–µ—Ä–≤—ã–π –ª–∏ –∑–∞–ø—É—Å–∫
            if (!localStorage.getItem(CAT_NAME_KEY)) {
                setTimeout(() => {
                    TWA.showPopup({
                        title: "–ó–ê–ù–û–í–û!",
                        message: `–≠–π, *–ª–æ—Ö*, —Ç—ã –∫—Ç–æ? –ö–∞–∫ —Ç–µ–±—è –Ω–∞–∑—ã–≤–∞—Ç—å, *${userName}*? –ü—Ä–∏–¥—É–º–∞–π –¥–ª—è –º–µ–Ω—è —É–≥–∞—Ä–Ω–æ–µ –∏–º—è.`,
                        buttons: [{id: 'input', text: '–ü–†–ò–î–£–ú–ê–¢–¨', type: 'default'}]
                    }, (buttonId) => {
                         if (buttonId === 'input') {
                            const newName = prompt("–í–≤–µ–¥–∏ –∏–º—è –¥–ª—è –ö–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ü–ò–°–¨–ö–ê):");
                            if (newName && newName.trim().length > 0) {
                                catName = newName.toUpperCase().trim();
                                saveData();
                                catNameDisplay.textContent = `${catName} ‚Äî –¢–í–û–ô –•–£–ï–°–û–°-–ü–û–ú–û–©–ù–ò–ö!`;
                                chatOutput.innerHTML = `<span class="message-status">${catName}:</span> –¢–µ–ø–µ—Ä—å —è **${catName}**. –Ø –∑–∞–ø–æ–º–Ω–∏–ª. –ê —Ç–µ–ø–µ—Ä—å –ø–∏–∑–¥—É–π, –∑–∞–¥–∞–≤–∞–π —Ç—É–ø—ã–µ –≤–æ–ø—Ä–æ—Å—ã!`;
                            }
                         }
                    });
                }, 500);
            } else {
                 chatOutput.innerHTML = `<span class="message-status">${catName}:</span> –Ø —Ç—É—Ç, *${userName}*. –ß—ë –Ω–∞–¥–æ? –ù–µ –æ—Ç–≤–ª–µ–∫–∞–π –º–µ–Ω—è –æ—Ç –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏.`;
            }
        }

        sendButton.addEventListener('click', handleSend);
        textInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleSend();
        });

        initializeApp();
    </script>
</body>
</html>
